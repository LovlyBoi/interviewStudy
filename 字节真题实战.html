<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Promise.all手写</title>
    <style>
        /* 直角三角形 */
        .triangle {
            width: 0px;
            height: 0px;
            border: 100px solid #ddd;
            border-top-color: transparent;
            border-right-color: transparent;
            border-left-color: transparent;
            position: relative;
            left: 50%;
        }
        
        .box {
            width: 100px;
            height: 100px;
            background: lawngreen;
            /* transform:translate(100px,100px) rotate(45deg); */
            transform:rotate(45deg) translateX(100px) translateY(100px);
        }
    </style>
</head>

<body>  

    <div class="box">1</div>

    <div class="triangle"></div>

    <script>
        document.getElementsByClassName("triangle")[0].addEventListener("click", (e) => {
            console.log("capture1");
            e.stopPropagation();
        }, true);

        document.getElementsByClassName("triangle")[0].addEventListener("click", () => {
            console.log("click");
        });

        document.body.addEventListener("click", () => {
            console.log("body capture")
        }, true)

        document.body.addEventListener("click", () => {
            console.log("body click")
        }, false)
        // Promise.myAll = function (promises) {
        //     return new Promise((resolve, reject) => {
        //         // 1. 首先这个参数promises他不一定非要是一个数组, 而是只要是可迭代对象都ok的
        //         // 所以先判断他是不是可迭代对象
        //         if (typeof promises[Symbol.iterator] !== "function") {
        //             throw new TypeError("first argument must be an iterator");
        //         }
        //         let finishedCount = 0;
        //         let taskCount = 0;
        //         const result = [];
        //         for (let promiseTask of promises) {
        //             let currentIndex = taskCount;
        //             taskCount++;
        //             Promise.resolve(promiseTask).then(data => {
        //                 result[currentIndex] = data;
        //                 finishedCount++;
        // //                 if (finishedCount >= taskCount) {
        // //                     // 代表处理完了
        // //                     resolve(result);
        // //                 }
        // //             }).catch(reason => reject(reason))
        // //         }
        // //     })
        // // }

        // // // 测试
        // // const pro1 = new Promise((resolve) => {
        // //     setTimeout(() => {
        // //         resolve(1);
        // //     }, 2000)
        // // })

        // // const pro2 = Promise.resolve(2);

        // // const pro3 = Promise.resolve(3);

        // // // Promise.myAll([pro1, pro2, pro3, Promise.reject("err")]).then(data => {
        // // //     console.log("data", data);
        // // // }).catch(reason => {
        // // //     console.log("reason", reason);
        // // // })


        // // // for in 
        // // function Person() {
        // // }

        // // Person.prototype.lastName = "李";

        // // const person = new Person();

        // // person.sex = 1;

        // // for (const prop in person) {
        // //     if (person.hasOwnProperty(prop)) {
        // //         console.log("prop", prop);
        // //     }
        // // }


        // // console.log("Object.values", Object.entries(person));

        // // console.log(Object.getOwnPropertyNames(person));


        // const arr = [1, 3, 2, 5, 2, 3, 4, 5];
        // function unique(arr) {
        //     const _arr = JSON.parse(JSON.stringify(arr)).sort((a, b) => a - b);
        //     let compareValue = null;
        //     const result = [];
        //     for (let i = 0, len = _arr.length; i < len; i++) {
        //        if (!i || compareValue !== _arr[i]) {
        //            // 如果不是第一个元素或者compareValue和当前的arr不相等, 则可以push
        //            result.push(_arr[i]);
        //            compareValue = _arr[i];
        //        }
        //     }
        //     return result; 
        // }

        // console.log(unique(arr));

        // {
        //     console.log("a", a);
        //     let a = 10;
        // }
        // const obj = {}
        // const wm = new WeakMap([[obj, 1]])
        // for (const item of wm) {

        // }

        // function print() {
        //     console.log(this.a);
        // }

        // print.bind({a: 10}).bind({a: 20})();

        // Promise.all([new Promise((res, rej) => {
        //     console.log("1");
        //     setTimeout(() => {
        //         rej("err");
        //     }, 1000)
        // }), new Promise((res, rej) => {
        //     console.log("2");
        //     setTimeout(() => {
        //         res(1)
        //     }, 2000)
        // })]).then(r => {
        //     console.log("r", r);
        // }).catch(err => {
        //     console.log("err", err);
        // })

        // async function bar() {
        // try {
        //  await   Promise.reject(1);
        // } catch(err) {
        //     console.log("err", err);
        // }
        // }

        // bar();

        const pro = new Promise((res, rej) => {
            setTimeout(() => {
                rej("error");
            })
        })

        pro.finally(r => {
            console.log("r", r);
        })

    </script>

    
</body>

</html>